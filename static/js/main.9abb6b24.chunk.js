(this["webpackJsonpsea-battle"]=this["webpackJsonpsea-battle"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var i=n(2),r=n.n(i),a=n(4),c=n.n(a),o=(n(13),n(8)),s=n(3),l=n(7),u=n(1);n(14);var d=n(0),h=20,j=Array.from(Array(10)).map((function(e,t){return t+1})),b=["\u0430","\u0431","\u0432","\u0433","\u0434","\u0435","\u0436","\u0437","\u0438","\u043a"],x={blue:"#3399cc",black:"#000000",red:"#cc0000",gray:"#999999"};function v(e){var t="Game-object__rect"+(e.className?" ".concat(e.className):"");return Object(d.jsx)("rect",{width:e.width*h+1,height:e.height*h+1,x:e.x*h,y:e.y*h,className:t,stroke:x[e.color],onPointerDown:e.onPointerDown})}function f(e){return Object(d.jsx)("circle",{cx:e.x*h+10+.5,cy:e.y*h+10+.5,r:e.r,fill:x[e.color]})}function y(e){return Object(d.jsxs)("div",{style:{position:"relative"},children:[Object(d.jsx)("div",{className:"Game-object__background",style:{position:"absolute",top:10,left:10,right:9,bottom:9}}),Object(d.jsx)("svg",{className:"Game-object__zone",width:e.width*h,height:e.height*h,viewBox:"".concat(e.x*h-10," ").concat(e.y*h-10," ").concat(e.width*h," ").concat(e.height*h),children:e.children})]})}function O(e){return Object(d.jsx)("text",{x:e.x*h+10+1,y:e.y*h+10+1,fontFamily:"inherit",dominantBaseline:"middle",textAnchor:"middle",fontSize:12,children:e.children})}function m(e){var t=e.x,n=e.y;return Object(d.jsxs)("g",{children:[Object(d.jsx)(v,{width:10,height:10,x:t+1,y:n+1,color:"black"}),j.map((function(e,i){return Object(d.jsx)(O,{x:t,y:n+i+1,children:e},e)})),b.map((function(e,i){return Object(d.jsx)(O,{x:t+i+1,y:n,children:e.toUpperCase()},e)}))]})}function g(e){var t=1,n=1;"horizontal"===e.orientation?t=e.size:n=e.size;var i="Ship";return e.isDraggable&&(i+=" Ship--draggable"),e.isDragging&&(i+=" Ship--dragging"),Object(d.jsx)(v,{width:t,height:n,x:e.x,y:e.y,color:e.color,className:i,onPointerDown:e.onPointerDown})}var p=[{size:4,x:0,y:0},{size:3,x:0,y:2},{size:3,x:5,y:2},{size:2,x:0,y:4},{size:2,x:3,y:4},{size:2,x:6,y:0},{size:1,x:0,y:6},{size:1,x:4,y:6},{size:1,x:7,y:6},{size:1,x:7,y:4}].map((function(e,t){return Object(u.a)(Object(u.a)({},e),{},{id:t,orientation:"horizontal"})}));function z(e){for(var t=[],n=e.x,i=e.y,r=e.size,a=e.orientation,c="horizontal"===a?r:1,o="vertical"===a?r:1,s=n-1;s<n+c+1;s++)for(var l=i-1;l<i+o+1;l++)s>=n&&s<n+c&&l>=i&&l<i+o||s<1||s>10||l<1||l>10||t.push(Object(d.jsx)(f,{r:1.5,x:s,y:l,color:"gray"},s+"-"+l));return t}var w=function(){var e=Object(i.useState)((function(){return{keys:(e=p.map((t=2,n=2,function(e){return Object(u.a)(Object(u.a)({},e),{},{x:e.x+t,y:e.y+n})}))).map((function(e){return e.id})),entries:e.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(s.a)({},t.id,t))}),{})};var e,t,n})),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(i.useState)(null),j=Object(l.a)(c,2),b=j[0],x=j[1],v=Object(i.useMemo)((function(){return n.keys.map((function(e){return n.entries[e]}))}),[n.keys,n.entries]),f=Object(i.useMemo)((function(){return function(e,t){var n,i={},r=new Set,a=Object(o.a)(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;u(c),s(c),l(c)}}catch(d){a.e(d)}finally{a.f()}return{invalidShips:r,valid:0===r.size};function s(e){for(var t=e.x,n=e.y,a=e.size,c=e.orientation,o="horizontal"===c?a:1,s="vertical"===c?a:1,l=t;l<t+o;l++)for(var u=n;u<n+s;u++){var d,h=null===(d=i[u])||void 0===d?void 0:d[l];null!=h&&h!==e.id&&(r.add(e.id),r.add(h))}}function l(e){for(var t=e.x,n=e.y,r=e.size,a=e.orientation,c="horizontal"===a?r:1,o="vertical"===a?r:1,s=t-1;s<t+c+1;s++)for(var l=n-1;l<n+o+1;l++)i[l]=i[l]||{},null==i[l][s]&&(i[l][s]=e.id)}function u(e){var n=e.x,i=e.y,a=e.size,c=e.orientation,o=t.y+t.height,s=t.x+t.width;n<t.x||i<t.y?r.add(e.id):"vertical"===c?(i+a>o||n>=s)&&r.add(e.id):(i>=o||n+a>s)&&r.add(e.id)}}(v,{x:1,y:1,width:10,height:10})}),[v]),O=f.invalidShips,w=f.valid;return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)("h1",{children:"\u041c\u043e\u0440\u0441\u043a\u043e\u0439 \u0411\u043e\u0439"}),Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"\u0420\u0430\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043e\u0440\u0430\u0431\u043b\u0435\u0439"}),Object(d.jsx)("div",{className:"App__game-field-wrapper",children:Object(d.jsxs)(y,{x:0,y:0,width:25,height:13,children:[Object(d.jsx)(m,{x:0,y:0}),v.map((function(e){return Object(d.jsxs)(i.Fragment,{children:[Object(d.jsx)(g,Object(u.a)(Object(u.a)({},e),{},{x:e.x,y:e.y,color:O.has(e.id)?"red":"blue",isDraggable:!0,isDragging:b===e.id,onPointerDown:(t=e.id,function(e){e.preventDefault();var n=e.currentTarget;document.addEventListener("pointermove",l),document.addEventListener("pointerup",(function e(){Object(a.unstable_batchedUpdates)((function(){o||r((function(e){var n,i=e.entries[t];return null==i?e:Object(u.a)(Object(u.a)({},e),{},{entries:Object(u.a)(Object(u.a)({},e.entries),{},Object(s.a)({},t,(n=i,Object(u.a)(Object(u.a)({},n),{},{orientation:"horizontal"===n.orientation?"vertical":"horizontal"}))))})})),x(null)})),n.style.cursor="",document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",e)}));var i,c,o=!1;function l(a){a.preventDefault();var l=a.clientX-e.clientX,d=a.clientY-e.clientY;(Math.abs(l)>h/3||Math.abs(d)>h/3)&&(o=!0,x(t),n.style.cursor="grabbing"),o&&r((function(e){var n=e.entries[t];if(null==n)return e;null!=i&&null!=c||(i=n.x,c=n.y);var r,a,o="vertical"===n.orientation?1:n.size,j="horizontal"===n.orientation?1:n.size,b=Math.min(25-o-1,Math.max(0,i+Math.round(l/h))),x=Math.min(13-j-1,Math.max(0,c+Math.round(d/h)));return n.x===b&&n.y===x?e:Object(u.a)(Object(u.a)({},e),{},{entries:Object(u.a)(Object(u.a)({},e.entries),{},Object(s.a)({},t,(r=b,a=x,function(e){return Object(u.a)(Object(u.a)({},e),{},{x:r,y:a})})(n)))})}))}})})),null!=b&&z(e)]},e.id);var t}))]})})]}),Object(d.jsx)("button",{disabled:!w,children:"\u0413\u043e\u0442\u043e\u0432\u043e"})]})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),i(e),r(e),a(e),c(e)}))};c.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(w,{})}),document.getElementById("root")),D()}},[[16,1,2]]]);
//# sourceMappingURL=main.9abb6b24.chunk.js.map